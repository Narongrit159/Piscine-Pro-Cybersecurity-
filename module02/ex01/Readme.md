# Padding Oracle Attack

## ภาพรวม

โปรเจคนี้เป็นการสาธิตช่องโหว่ประเภท Padding Oracle
ซึ่งเกิดในระบบที่ใช้การเข้ารหัสแบบ block cipher (เช่น AES-CBC)
และมีการตอบสนอง (response) แตกต่างกัน เมื่อ padding ถูกหรือผิด

ผู้โจมตีสามารถอาศัยความแตกต่างของ response นี้
เพื่อค่อยๆ เดาค่าข้อมูลที่ถูกเข้ารหัสไว้ได้ทีละ byte
โดยไม่จำเป็นต้องรู้ secret key

ผลลัพธ์คือสามารถถอดรหัสข้อมูลสำคัญ
หรือข้ามขั้นตอนการยืนยันตัวตน (login) ได้

Exercise 02 เป้าหมายของคุณคือการ Login เข้าสู่ระบบให้สำเร็จโดยไม่ต้องใช้รหัสผ่านที่ถูกต้อง และ ห้ามใช้ SQL Injection (SQLI) ช่องโหว่หลักของข้อนี้คือ Padding Oracle ซึ่งเกิดขึ้นเมื่อแอปพลิเคชันเปิดเผยข้อมูลเกี่ยวกับความถูกต้องของ "Padding" ในการถอดรหัส (Decryption) ข้อมูล

---

## ประเภทของช่องโหว่

- Padding Oracle
- Cryptographic Vulnerability (OWASP)

---

## หลักการทำงานโดยสรุป

1. ระบบใช้การเข้ารหัสแบบ CBC ซึ่งต้องมี padding
2. เมื่อ server ถอดรหัส จะตรวจสอบว่า padding ถูกต้องหรือไม่
3. หาก padding ผิด จะตอบ error แบบหนึ่ง
4. หาก padding ถูก จะตอบอีกแบบหนึ่ง

เพียงแค่นี้ ผู้โจมตีก็สามารถ:

- ส่ง ciphertext ที่ถูกแก้ไขเข้าไป
- สังเกต response ของ server
- ใช้ server เป็น “oracle”
- เดาค่า plaintext ทีละ byte

ทำซ้ำไปเรื่อยๆ จนได้ข้อมูลเดิมครบทั้งหมด

---

## เป้าหมายของการทดสอบ

ในแลบนี้ เป้าหมายคือสามารถ login เข้าระบบได้
โดยไม่ทราบรหัสผ่านจริง
และไม่ใช้ SQL Injection

---

## ผลกระทบ

หากเกิดในระบบจริง อาจนำไปสู่:

- การถอดรหัส session / cookie
- การปลอมตัวเป็นผู้ใช้รายอื่น
- การเข้าถึงข้อมูลลับ
- การ bypass ระบบยืนยันตัวตน

---

## ตัวอย่างสถานการณ์จริง

- เว็บใช้ encrypted cookie สำหรับ auth
- API ส่ง token แบบ AES-CBC
- ระบบตอบ error ต่างกันเมื่อ decrypt ไม่ผ่าน

ทั้งหมดนี้มีความเสี่ยงต่อ Padding Oracle
